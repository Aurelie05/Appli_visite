import{r,a as m,j as o}from"./app-DDj-hOFe.js";/* empty css            */function j(){const n=r.useRef(null),c=r.useRef(null),[u,p]=r.useState(null),[l,v]=r.useState(!1),[h,f]=r.useState(!1);return r.useEffect(()=>{navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(s=>{p(s),n.current&&(n.current.srcObject=s,n.current.play())}).catch(s=>console.error("Erreur caméra:",s))},[]),r.useEffect(()=>{if(!n.current||!c.current)return;const s=setInterval(()=>{if(l)return;const a=n.current,e=c.current;if(!a||!e)return;const d=e.getContext("2d");if(!d)return;e.width=a.videoWidth,e.height=a.videoHeight,d.drawImage(a,0,0,e.width,e.height);const g=e.toDataURL("image/png");m.post("/scan-cni",{image:g},{preserveScroll:!0,onSuccess:i=>{const t=i.props.data||{};(t.nom||t.prenom||t.numero)&&(f(!0),setTimeout(()=>f(!1),150),console.log("CNI détectée :",t),v(!0),u?.getTracks().forEach(x=>x.stop()),m.visit("/formulaire",{method:"get",data:{nom:t.nom,prenom:t.prenom,numero_cni:t.numero}}))},onError:i=>console.error("Erreur OCR:",i)})},4e3);return()=>clearInterval(s)},[l,u]),o.jsxs("div",{style:{position:"relative"},children:[h&&o.jsx("div",{style:{position:"absolute",inset:0,background:"white",opacity:.9,zIndex:20,pointerEvents:"none",animation:"flash 0.15s ease-out"}}),o.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,className:"w-full h-auto"}),o.jsx("canvas",{ref:c,style:{display:"none"}}),o.jsx("style",{children:`
                    @keyframes flash {
                        from { opacity: 0.9; }
                        to { opacity: 0; }
                    }
                `})]})}export{j as default};
