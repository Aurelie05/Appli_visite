import{r as o,a as f,j as i}from"./app-DEaq_-iL.js";/* empty css            */function E(){const r=o.useRef(null),a=o.useRef(null),[u,m]=o.useState(null),[l,p]=o.useState(!1);return o.useEffect(()=>{navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(n=>{m(n),r.current&&(r.current.srcObject=n,r.current.play())}).catch(n=>console.error("Erreur caméra:",n))},[]),o.useEffect(()=>{if(!r.current||!a.current)return;const n=setInterval(()=>{if(l)return;const s=r.current,e=a.current;if(!s||!e)return;const d=e.getContext("2d");if(!d)return;e.width=s.videoWidth,e.height=s.videoHeight,d.drawImage(s,0,0,e.width,e.height);const v=e.toDataURL("image/png");f.post("/scan-cni",{image:v},{preserveScroll:!0,onSuccess:c=>{const t=c.props.data||{};t.nom||t.prenom||t.numero?(console.log("CNI détectée :",t),p(!0),u?.getTracks().forEach(g=>g.stop()),f.visit("/formulaire",{method:"get",data:{nom:t.nom,prenom:t.prenom,numero_cni:t.numero}})):console.log("Pas de CNI détectée pour cette image. Vérifier luminosité et position de la carte.")},onError:c=>console.error("Erreur OCR:",c)})},6e3);return()=>clearInterval(n)},[l,u]),i.jsxs("div",{children:[i.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,className:"w-full h-auto"}),i.jsx("canvas",{ref:a,style:{display:"none"}})]})}export{E as default};
